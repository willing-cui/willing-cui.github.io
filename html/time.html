<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="page_title">Elegant Live Clock with Date Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Add flatpickr for calendar date picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="../assets/css/main.css" />
    <link rel="stylesheet" rel="prefetch" href="../assets/css/custom.css" />
    <link rel="stylesheet" rel="prefetch" href="../assets/css/time.css" />

    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/js/dynamic_stickies_bg.js"></script>
    <script src="../assets/js/util.js"></script>
    <!-- Add flatpickr for date picker -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" type="text/css" href="https://npmcdn.com/flatpickr/dist/themes/dark.css">

    <style>
        .flatpickr-current-month .numInputWrapper {
            width: 6ch;
            display: inline-block;
            position: absolute;
            top: 6px;
            right: 18px;
        }
    </style>
</head>

<body class="is-preload">
    <!-- BG -->
    <div id="bg" style="z-index: -100;"></div>
    <!-- Close Button -->
    <a href="../index.html">
        <div class="stickies_icon" style="background-image: url('../images/close-w.png');" 
             title="Close" data-i18n-title="close_title"></div>
    </a>

    <!-- Navigation Arrows -->
    <div class="nav-arrow nav-arrow-left" id="arrowLeft">
        <i class="fas fa-chevron-left"></i>
    </div>

    <div class="nav-arrow nav-arrow-right" id="arrowRight">
        <i class="fas fa-chevron-right"></i>
    </div>

    <div class="container">
        <div class="swiper-container">
            <div class="page-indicator">
                <div class="indicator-dot active" data-page="0"></div>
                <div class="indicator-dot" data-page="1"></div>
            </div>

            <div class="pages-wrapper" id="pagesWrapper">
                <!-- Page 1: Current Time -->
                <div class="page" id="page1">
                    <h2 class="page-title"><i class="fas fa-clock"></i> <span data-i18n="current_time_title">Current Time</span></h2>
                    <p class="page-subtitle" data-i18n="current_time_subtitle">Real-time display of current date and time</p>

                    <div class="clock-container">
                        <div class="time-section">
                            <div class="time-display" id="hours">00</div>
                            <div class="time-label" data-i18n="hours_label">Hours</div>
                        </div>

                        <div class="time-section">
                            <div class="time-display" id="minutes">00</div>
                            <div class="time-label" data-i18n="minutes_label">Minutes</div>
                        </div>

                        <div class="time-section">
                            <div class="time-display" id="seconds">00</div>
                            <div class="time-label" data-i18n="seconds_label">Seconds</div>
                        </div>

                        <div class="time-section">
                            <div class="time-display" id="ampm">AM</div>
                            <div class="time-label" data-i18n="meridiem_label">Meridiem</div>
                        </div>
                    </div>

                    <div class="date-container hide-scrollbar">
                        <div class="day-of-week">
                            <i class="far fa-calendar-alt calendar-icon"></i>
                            <span id="dayname">Monday</span>
                        </div>
                        <div class="full-date" id="fulldate">January 1, 2023</div>

                        <div class="additional-info">
                            <div class="info-box">
                                <div class="info-title" data-i18n="day_of_year">Day of Year</div>
                                <div class="info-value" id="dayofyear">001</div>
                            </div>
                            <div class="info-box">
                                <div class="info-title" data-i18n="week_number">Week Number</div>
                                <div class="info-value" id="weeknumber">01</div>
                            </div>
                            <div class="info-box">
                                <div class="info-title" data-i18n="timezone">Timezone</div>
                                <div class="info-value" id="timezone">UTC</div>
                            </div>
                        </div>
                    </div>

                    <div class="navigation-hint">
                        <i class="fas fa-arrow-right"></i> <span data-i18n="navigation_hint_right">Swipe or click arrows to switch pages</span>
                    </div>
                </div>

                <!-- Page 2: Date Calculator -->
                <div class="page" id="page2">
                    <h2 class="page-title"><i class="far fa-calendar-check"></i> <span data-i18n="date_calculator_title">Date Difference Calculator</span></h2>
                    <p class="page-subtitle" data-i18n="date_calculator_subtitle">Select a date to calculate time difference. Past dates show elapsed time, future dates show countdown.</p>

                    <div class="date-calculator hide-scrollbar">
                        <div class="date-input-section">
                            <div class="date-input-group">
                                <label for="datePicker"><i class="fas fa-calendar-day"></i> <span data-i18n="select_past_date">Select a Past Date</span></label>
                                <input type="text" id="datePicker" class="date-input" placeholder="" data-i18n-placeholder="click_to_select_date">
                            </div>

                            <div class="date-input-group">
                                <label for="timePicker"><i class="fas fa-clock"></i> <span data-i18n="select_time">Select Time (Optional)</span></label>
                                <input type="text" id="timePicker" class="date-input" placeholder="" data-i18n-placeholder="click_to_select_time">
                            </div>
                        </div>

                        <div id="selectedDateDisplay" class="selected-date-display">
                            <div id="selectedDateDetails" class="selected-date-details">
                                <span>-</span>
                                <span>•</span>
                                <span>-</span>
                                <span>•</span>
                                <span>-</span>
                            </div>
                        </div>

                        <div id="timeDifference" class="time-difference">
                            <div class="difference-box">
                                <div class="time-display" id="yearsDiff">0</div>
                                <div class="time-label" data-i18n="years_label">Years</div>
                            </div>
                            <div class="difference-box">
                                <div class="time-display" id="monthsDiff">0</div>
                                <div class="time-label" data-i18n="months_label">Months</div>
                            </div>
                            <div class="difference-box">
                                <div class="time-display" id="daysDiff">0</div>
                                <div class="time-label" data-i18n="days_label">Days</div>
                            </div>
                            <div class="difference-box">
                                <div class="time-display" id="hoursDiff">0</div>
                                <div class="time-label" data-i18n="hours_label">Hours</div>
                            </div>
                            <div class="difference-box">
                                <div class="time-display" id="minutesDiff">0</div>
                                <div class="time-label" data-i18n="minutes_label">Minutes</div>
                            </div>
                            <div class="difference-box">
                                <div class="time-display" id="secondsDiff">0</div>
                                <div class="time-label" data-i18n="seconds_label">Seconds</div>
                            </div>
                        </div>
                    </div>

                    <div class="navigation-hint">
                        <i class="fas fa-arrow-left"></i> <span data-i18n="navigation_hint_left">Swipe or click arrows to switch pages</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer id="footer">
            <p class="copyright">&copy; 2026 Hongwei CUI (Willing). All Rights Reserved. 版权所有</p>
            <a class="copyright" href="https://beian.miit.gov.cn/" target="_blank">鲁ICP备2025192750号-1</a>
            <img id="filing-icon" src="../images/备案图标.png" /><a class="copyright"
                href="https://beian.mps.gov.cn/#/query/webSearch?code=37078302000937" rel="noreferrer"
                target="_blank">鲁公网安备37078302000937号</a>
        </footer>
    </div>

    <script>
        (function ($) {
            var $window = $(window), $body = $('body');
            // Play initial animations on page load.
            $window.on('load', function () {
                window.setTimeout(function () {
                    $body.removeClass('is-preload');
                }, 100);
            });
        })(jQuery);
    </script>
    
    <script>
        // 语言资源文件
        const translations = {
            en: {
                "page_title": "Clock and Date Calculator",
                "current_time_title": "Current Time",
                "current_time_subtitle": "Real-time display of current date and time",
                "date_calculator_title": "Date Difference Calculator",
                "date_calculator_subtitle": "Select a date to calculate time difference. Past dates show elapsed time, future dates show countdown.",
                "hours_label": "Hours",
                "minutes_label": "Minutes",
                "seconds_label": "Seconds",
                "meridiem_label": "Meridiem",
                "day_of_year": "Day of Year",
                "week_number": "Week Number",
                "timezone": "Timezone",
                "select_past_date": "Select a Past Date",
                "select_time": "Select Time (Optional)",
                "click_to_select_date": "Click to select date...",
                "click_to_select_time": "Click to select time...",
                "years_label": "Years",
                "months_label": "Months",
                "days_label": "Days",
                "navigation_hint_right": "Swipe or click arrows to switch pages",
                "navigation_hint_left": "Swipe or click arrows to switch pages",
                "close_title": "Close",
                
                // 星期和月份名称
                "sunday": "Sunday",
                "monday": "Monday",
                "tuesday": "Tuesday",
                "wednesday": "Wednesday",
                "thursday": "Thursday",
                "friday": "Friday",
                "saturday": "Saturday",
                "january": "January",
                "february": "February",
                "march": "March",
                "april": "April",
                "may": "May",
                "june": "June",
                "july": "July",
                "august": "August",
                "september": "September",
                "october": "October",
                "november": "November",
                "december": "December"
            },
            zh: {
                "page_title": "时钟与日期计算器",
                "current_time_title": "当前时间",
                "current_time_subtitle": "实时显示当前日期和时间",
                "date_calculator_title": "日期差计算器",
                "date_calculator_subtitle": "选择一个日期来计算时间差。过去日期显示已过时间，未来日期显示倒计时。",
                "hours_label": "小时",
                "minutes_label": "分钟",
                "seconds_label": "秒",
                "meridiem_label": "上下午",
                "day_of_year": "一年中的第几天",
                "week_number": "周数",
                "timezone": "时区",
                "select_past_date": "选择过去日期",
                "select_time": "选择时间（可选）",
                "click_to_select_date": "点击选择日期...",
                "click_to_select_time": "点击选择时间...",
                "years_label": "年",
                "months_label": "月",
                "days_label": "天",
                "navigation_hint_right": "滑动或点击箭头切换页面",
                "navigation_hint_left": "滑动或点击箭头切换页面",
                "close_title": "关闭",
                
                // 星期和月份名称
                "sunday": "星期日",
                "monday": "星期一",
                "tuesday": "星期二",
                "wednesday": "星期三",
                "thursday": "星期四",
                "friday": "星期五",
                "saturday": "星期六",
                "january": "1月",
                "february": "2月",
                "march": "3月",
                "april": "4月",
                "may": "5月",
                "june": "6月",
                "july": "7月",
                "august": "8月",
                "september": "9月",
                "october": "10月",
                "november": "11月",
                "december": "12月"
            }
        };

        // 全局变量
        let selectedDateTime = null;
        let datePicker = null;
        let timePicker = null;

        // 获取当前语言
        function getCurrentLanguage() {
            const savedLang = localStorage.getItem('preferred-language');
            const browserLang = navigator.language.startsWith('zh') ? 'zh' : 'en';
            return savedLang || browserLang || 'en';
        }

        // 设置语言
        function setLanguage(lang) {
            // 更新页面标题
            document.title = translations[lang].page_title;
            
            // 更新所有带 data-i18n 属性的元素
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = translations[lang][key];
                    } else if (element.hasAttribute('title')) {
                        element.setAttribute('title', translations[lang][key]);
                    } else {
                        element.textContent = translations[lang][key];
                    }
                }
            });
            
            // 更新所有带 data-i18n-placeholder 属性的元素
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });
            
            // 更新所有带 data-i18n-title 属性的元素
            document.querySelectorAll('[data-i18n-title]').forEach(element => {
                const key = element.getAttribute('data-i18n-title');
                if (translations[lang][key]) {
                    element.setAttribute('title', translations[lang][key]);
                }
            });
            
            // 更新页面语言属性
            document.documentElement.lang = lang;
            
            // 重新加载时间显示
            updateClock();
            
            // 重新配置日期选择器（保留事件监听器）
            updateDatePickerLanguage(lang);
        }

        // 更新日期选择器语言（不重新初始化，只更新配置）
        function updateDatePickerLanguage(lang) {
            if (datePicker) {
                datePicker.set('locale', lang === 'zh' ? 'zh' : 'en');
            }
            if (timePicker) {
                timePicker.set('locale', lang === 'zh' ? 'zh' : 'en');
            }
        }

        // Function to update selected date and time
        function updateSelectedDateTime() {
            const date = datePicker.selectedDates[0];
            const time = timePicker.selectedDates[0];

            if (date) {
                selectedDateTime = new Date(date);

                // If time is selected, combine with date
                if (time) {
                    selectedDateTime.setHours(time.getHours(), time.getMinutes(), time.getSeconds());
                } else {
                    // Default to start of day if no time selected
                    selectedDateTime.setHours(0, 0, 0, 0);
                }

                // Show selected date display
                document.getElementById('selectedDateDisplay').style.display = 'block';

                // Calculate immediately
                calculateTimeDifference();
            }
        }

        // 添加storage事件监听器
        window.addEventListener('storage', function(e) {
            if (e.key === 'preferred-language') {
                setLanguage(e.newValue || 'en');
            }
        });

        // 页面加载时设置语言
        $(function () {
            // 根据当前语言加载内容
            const lang = getCurrentLanguage();
            
            // 设置初始语言
            setLanguage(lang);
        });
    </script>
    
    <script>
        // Swipe functionality
        let currentPage = 0;
        const pagesWrapper = document.getElementById('pagesWrapper');
        const indicatorDots = document.querySelectorAll('.indicator-dot');
        const arrowLeft = document.getElementById('arrowLeft');
        const arrowRight = document.getElementById('arrowRight');
        let touchStartX = 0;
        let touchEndX = 0;

        // Function to update arrows state
        function updateArrows() {
            arrowLeft.classList.toggle('disabled', currentPage === 0);
            arrowRight.classList.toggle('disabled', currentPage === 1);
        }

        // Function to go to specific page
        function goToPage(pageIndex) {
            if (pageIndex < 0 || pageIndex > 1) return;

            currentPage = pageIndex;
            pagesWrapper.style.transform = `translateX(-${currentPage * 50}%)`;

            // Update indicator dots
            indicatorDots.forEach((dot, index) => {
                if (index === currentPage) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });

            // Update arrows state
            updateArrows();
        }

        // Add click events to indicator dots
        indicatorDots.forEach((dot, index) => {
            dot.addEventListener('click', () => {
                goToPage(index);
            });
        });

        // Add click events to arrows
        arrowLeft.addEventListener('click', () => {
            if (currentPage > 0) {
                goToPage(currentPage - 1);
            }
        });

        arrowRight.addEventListener('click', () => {
            if (currentPage < 1) {
                goToPage(currentPage + 1);
            }
        });

        // Swipe detection
        pagesWrapper.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });

        pagesWrapper.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        // Mouse drag support
        let isDragging = false;
        let startX = 0;
        let currentTranslate = 0;

        pagesWrapper.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.pageX;
            pagesWrapper.style.transition = 'none';
        });

        pagesWrapper.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            e.preventDefault();
            const currentX = e.pageX;
            const diff = currentX - startX;

            // Limit dragging to page boundaries
            const maxTranslate = 0;
            const minTranslate = -50;
            let newTranslate = -currentPage * 50 + (diff / pagesWrapper.offsetWidth) * 100;

            if (newTranslate > maxTranslate) newTranslate = maxTranslate;
            if (newTranslate < minTranslate) newTranslate = minTranslate;

            pagesWrapper.style.transform = `translateX(${newTranslate}%)`;
        });

        pagesWrapper.addEventListener('mouseup', (e) => {
            if (!isDragging) return;
            isDragging = false;
            pagesWrapper.style.transition = 'transform 0.5s cubic-bezier(0.4, 0, 0.2, 1)';

            const endX = e.pageX;
            const diff = endX - startX;
            const threshold = 50; // Minimum swipe distance

            if (Math.abs(diff) > threshold) {
                if (diff > 0 && currentPage > 0) {
                    // Swipe right
                    goToPage(currentPage - 1);
                } else if (diff < 0 && currentPage < 1) {
                    // Swipe left
                    goToPage(currentPage + 1);
                } else {
                    // Return to current page
                    goToPage(currentPage);
                }
            } else {
                // Return to current page
                goToPage(currentPage);
            }
        });

        pagesWrapper.addEventListener('mouseleave', () => {
            if (isDragging) {
                isDragging = false;
                pagesWrapper.style.transition = 'transform 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
                goToPage(currentPage);
            }
        });

        function handleSwipe() {
            const minSwipeDistance = 50;
            const swipeDistance = touchEndX - touchStartX;

            if (Math.abs(swipeDistance) < minSwipeDistance) return;

            if (swipeDistance > 0 && currentPage > 0) {
                // Swipe right
                goToPage(currentPage - 1);
            } else if (swipeDistance < 0 && currentPage < 1) {
                // Swipe left
                goToPage(currentPage + 1);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' && currentPage > 0) {
                goToPage(currentPage - 1);
            } else if (e.key === 'ArrowRight' && currentPage < 1) {
                goToPage(currentPage + 1);
            }
        });

        // Initialize arrows state
        updateArrows();

        // Format date and time for display with localization
        function formatDateTime(date) {
            const lang = getCurrentLanguage();
            const options = {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            
            if (lang === 'zh') {
                options.locale = 'zh-CN';
            } else {
                options.locale = 'en-US';
            }
            
            return date.toLocaleDateString(lang === 'zh' ? 'zh-CN' : 'en-US', options);
        }

        // Calculate time difference
        function calculateTimeDifference() {
            if (!selectedDateTime) return;

            const now = new Date();
            const diffInMs = selectedDateTime - now;

            const isFuture = diffInMs > 0;
            const absDiffInMs = Math.abs(diffInMs);

            // Calculate time differences
            const diffInSeconds = Math.floor(absDiffInMs / 1000);
            const diffInMinutes = Math.floor(diffInSeconds / 60);
            const diffInHours = Math.floor(diffInMinutes / 60);
            const diffInDays = Math.floor(diffInHours / 24);

            // Calculate years and months
            let years, months;

            if (isFuture) {
                // 未来时间：从当前时间到目标时间
                years = selectedDateTime.getFullYear() - now.getFullYear();
                months = selectedDateTime.getMonth() - now.getMonth();
            } else {
                // 过去时间：从目标时间到当前时间
                years = now.getFullYear() - selectedDateTime.getFullYear();
                months = now.getMonth() - selectedDateTime.getMonth();
            }

            if (months < 0) {
                years--;
                months += 12;
            }

            // Calculate remaining days
            let remainingDays = diffInDays;

            if (isFuture) {
                // 未来时间：从当前时间到目标时间
                const tempDate = new Date(now);
                tempDate.setFullYear(selectedDateTime.getFullYear(), selectedDateTime.getMonth(), now.getDate());

                if (tempDate > selectedDateTime) {
                    months--;
                    if (months < 0) {
                        years--;
                        months += 12;
                    }
                }

                // 计算剩余天数
                remainingDays = Math.floor((selectedDateTime - tempDate) / (1000 * 60 * 60 * 24));
                if (remainingDays < 0) {
                    const lastDayOfMonth = new Date(selectedDateTime.getFullYear(), selectedDateTime.getMonth() + 1, 0).getDate();
                    remainingDays += lastDayOfMonth;
                }
            } else {
                // 过去时间：从目标时间到当前时间
                const tempDate = new Date(selectedDateTime);
                tempDate.setFullYear(now.getFullYear(), now.getMonth(), selectedDateTime.getDate());

                if (tempDate > now) {
                    months--;
                    if (months < 0) {
                        years--;
                        months += 12;
                    }
                }

                remainingDays = Math.floor((now - tempDate) / (1000 * 60 * 60 * 24));
                if (remainingDays < 0) {
                    remainingDays += new Date(now.getFullYear(), now.getMonth(), 0).getDate();
                }
            }

            // 确保值不为负数
            years = Math.max(years, 0);
            months = Math.max(months, 0);
            remainingDays = Math.max(remainingDays, 0);

            // Update display
            document.getElementById('yearsDiff').textContent = years;
            document.getElementById('monthsDiff').textContent = months;
            document.getElementById('daysDiff').textContent = remainingDays;
            document.getElementById('hoursDiff').textContent = diffInHours % 24;
            document.getElementById('minutesDiff').textContent = diffInMinutes % 60;
            document.getElementById('secondsDiff').textContent = diffInSeconds % 60;

            // Add pulse animation to seconds
            const secondsDiffElement = document.getElementById('secondsDiff');
            secondsDiffElement.classList.remove('pulse');
            void secondsDiffElement.offsetWidth; // Trigger reflow
            secondsDiffElement.classList.add('pulse');

            // 修改：添加时间方向指示
            const timeDifferenceElement = document.getElementById('timeDifference');
            if (isFuture) {
                timeDifferenceElement.classList.add('future-time');
                timeDifferenceElement.classList.remove('past-time');
            } else {
                timeDifferenceElement.classList.add('past-time');
                timeDifferenceElement.classList.remove('future-time');
            }

            // Update selected date details
            updateSelectedDateDetails(isFuture, Math.floor(absDiffInMs / (1000 * 60 * 60 * 24)));
        }

        // Update selected date details
        function updateSelectedDateDetails(isFuture = false, diffInDays) {
            if (!selectedDateTime) return;

            const lang = getCurrentLanguage();
            const diffInWeeks = Math.floor(diffInDays / 7);
            const diffInMonths = Math.floor(diffInDays / 30.44);

            const details = document.getElementById('selectedDateDetails');

            if (isFuture) {
                if (lang === 'zh') {
                    details.innerHTML = `
                        <span>${diffInDays} 天后</span>
                        <span>•</span>
                        <span>${diffInWeeks} 周后</span>
                        <span>•</span>
                        <span>${diffInMonths} 个月后</span>
                    `;
                } else {
                    details.innerHTML = `
                        <span>In ${diffInDays} days</span>
                        <span>•</span>
                        <span>In ${diffInWeeks} weeks</span>
                        <span>•</span>
                        <span>In ${diffInMonths} months</span>
                    `;
                }
            } else {
                if (lang === 'zh') {
                    details.innerHTML = `
                        <span>${diffInDays} 天前</span>
                        <span>•</span>
                        <span>${diffInWeeks} 周前</span>
                        <span>•</span>
                        <span>${diffInMonths} 个月前</span>
                    `;
                } else {
                    details.innerHTML = `
                        <span>${diffInDays} days ago</span>
                        <span>•</span>
                        <span>${diffInWeeks} weeks ago</span>
                        <span>•</span>
                        <span>${diffInMonths} months ago</span>
                    `;
                }
            }
        }

        // 获取本地化的星期和月份名称
        function getLocalizedDayName(dayIndex) {
            const lang = getCurrentLanguage();
            const dayNames = {
                'en': ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'],
                'zh': ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday']
            };
            return translations[lang][dayNames[lang][dayIndex]] || dayNames['en'][dayIndex];
        }

        function getLocalizedMonthName(monthIndex) {
            const lang = getCurrentLanguage();
            const monthNames = {
                'en': ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'],
                'zh': ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december']
            };
            return translations[lang][monthNames[lang][monthIndex]] || monthNames['en'][monthIndex];
        }

        // Update the clock and date
        function updateClock() {
            const now = new Date();
            const lang = getCurrentLanguage();

            // Get time components
            let hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');

            // Determine AM/PM
            let ampm = hours >= 12 ? 'PM' : 'AM';
            ampmElement = document.getElementById('ampm');
            if (lang === 'zh') {
                ampm = hours >= 12 ? '下午' : '上午';
                ampmElement.style.fontWeight = 'lighter';
            }

            // Convert to 12-hour format
            hours = hours % 12 || 12;
            const formattedHours = hours.toString().padStart(2, '0');

            // Update time displays
            document.getElementById('hours').textContent = formattedHours;
            document.getElementById('minutes').textContent = minutes;
            document.getElementById('seconds').textContent = seconds;
            document.getElementById('ampm').textContent = ampm;

            // Add pulse animation to seconds
            const secondsElement = document.getElementById('seconds');
            secondsElement.classList.remove('pulse');
            void secondsElement.offsetWidth; // Trigger reflow
            secondsElement.classList.add('pulse');

            // Get localized date information
            const dayName = getLocalizedDayName(now.getDay());
            const month = getLocalizedMonthName(now.getMonth());
            const date = now.getDate();
            const year = now.getFullYear();

            // Update date displays
            document.getElementById('dayname').textContent = dayName;
            
            if (lang === 'zh') {
                document.getElementById('fulldate').textContent = `${year}年 ${month} ${date}日`;
            } else {
                document.getElementById('fulldate').textContent = `${month} ${date}, ${year}`;
            }

            // Calculate day of year
            const start = new Date(now.getFullYear(), 0, 0);
            const diff = now - start;
            const oneDay = 1000 * 60 * 60 * 24;
            const dayOfYear = Math.floor(diff / oneDay);
            document.getElementById('dayofyear').textContent = dayOfYear.toString().padStart(3, '0');

            // Calculate week number
            const firstDayOfYear = new Date(now.getFullYear(), 0, 1);
            const pastDaysOfYear = (now - firstDayOfYear) / 86400000;
            const weekNumber = Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
            document.getElementById('weeknumber').textContent = weekNumber.toString().padStart(2, '0');

            // Get timezone
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            document.getElementById('timezone').textContent = timezone.split('/')[0];

            // Update time difference if a date is selected
            if (selectedDateTime) {
                calculateTimeDifference();
            }
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize date picker
            const lang = getCurrentLanguage();
            
            datePicker = flatpickr("#datePicker", {
                enableTime: false,
                dateFormat: "Y-m-d",
                locale: lang === 'zh' ? 'zh' : 'en',
                onChange: function (selectedDates, dateStr, instance) {
                    if (selectedDates.length > 0) {
                        updateSelectedDateTime();
                    }
                }
            });

            timePicker = flatpickr("#timePicker", {
                enableTime: true,
                noCalendar: true,
                dateFormat: "H:i",
                time_24hr: true,
                locale: lang === 'zh' ? 'zh' : 'en',
                onChange: function (selectedDates, dateStr, instance) {
                    if (selectedDates.length > 0) {
                        updateSelectedDateTime();
                    }
                }
            });

            updateClock();

            // Update the clock every second
            setInterval(updateClock, 1000);

            // Add a visual effect to the time separators
            setInterval(() => {
                const hoursElement = document.getElementById('hours');
                const minutesElement = document.getElementById('minutes');

                // Add and remove a class to create a subtle highlight effect
                hoursElement.style.textShadow = '0 0 20px rgba(255, 126, 95, 0.7)';
                minutesElement.style.textShadow = '0 0 20px rgba(254, 180, 123, 0.7)';

                setTimeout(() => {
                    hoursElement.style.textShadow = '0 0 20px rgba(255, 255, 255, 0.3)';
                    minutesElement.style.textShadow = '0 0 20px rgba(255, 255, 255, 0.3)';
                }, 300);
            }, 5000);
        });
    </script>
</body>
</html>